{"version":3,"sources":["controllers/ProviderList/ProviderList.controller.ts"],"names":[],"mappings":"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","file":"controllers/ProviderList/ProviderList.controller.js","sourcesContent":["module ProviderListController {\r\n\r\n    class ProviderListController {\r\n        ServiceData: any;\r\n        pdata: number = 0;\r\n        PreviousID: string;\r\n        ServiceIDs: number;\r\n        profilePic: string;\r\n        static currentlatlong: any;\r\n        static $inject = ['$q', '$state', '$ionicPopup', '$ionicLoading', '$scope', '$location', 'CustomerHttp', '$window', 'toaster', 'SharedHttp'];\r\n        constructor(\r\n            private $q: ng.IQService,\r\n            private $state: angular.ui.IStateService,\r\n            private $ionicPopup: ionic.popup.IonicPopupService,\r\n            private $ionicLoading: ionic.loading.IonicLoadingService,\r\n            private $scope: ng.IScope,\r\n            private $location: ng.ILocationService,\r\n            private CustomerHttp: spafoo.httpservice.ICustomerScreenHttp,\r\n            private $window: ng.IWindowService,\r\n            private toaster: ngtoaster.IToasterService,\r\n            private SharedHttp: spafoo.httpsharedservice.ISharedHttp) {\r\n            var self = this;\r\n            self.ServiceIDs = self.$window.localStorage.getItem('ServiceIDs');\r\n            // alert(this.ServiceIDs);\r\n           \r\n         \r\n            \r\n         \r\n            var options = {\r\n                enableHighAccuracy: true,\r\n                maximumAge: 3600000\r\n            };\r\n            navigator.geolocation.getCurrentPosition(self.onSuccess, self.onError, options);\r\n            setTimeout(function () { self.getProviderList(self.ServiceIDs); }, 1000);\r\n        }\r\n        getProviderList(ServiceID: any) {\r\n            var self = this;\r\n\r\n            self.CustomerHttp.get('/ListProvidersByServices/' + ServiceID).then(function (response: any) {\r\n\r\n                self.ServiceData = response.ListProvidersByServicesResult;\r\n                for (var i = 0; i <= response.ListProvidersByServicesResult.length; i++) {\r\n                   \r\n                    if (self.ServiceData[i].profileField.photoField != null) {\r\n\r\n                        self.getProfilePics(self.ServiceData[i].profileField.photoField, i);\r\n                        self.GetProTagLine(self.ServiceData[i].userIDField, i);\r\n                        self.GetMyRating(self.ServiceData[i].userIDField, i);\r\n                       \r\n\r\n                    }\r\n                    else\r\n                    { self.ServiceData[i].profileField.photoField = \"\"; };\r\n                    //console.log(self.ServiceData[i].vanityUrlField)\r\n                    self.GetDistanceBetween(self.ServiceData[i].vanityUrlField, i);\r\n\r\n                }\r\n              \r\n\r\n\r\n            }, function (error) {\r\n                if (error === null) {\r\n                    self.$ionicLoading.hide();\r\n                } else {\r\n                    console.log(error);\r\n                    self.$ionicLoading.hide();\r\n                }\r\n            });\r\n\r\n        }\r\n        GetDistanceBetween(latlong: any, index: any)\r\n        {\r\n            var lat1 = latlong.substring(0, latlong.indexOf(':'));\r\n            var long1 = latlong.substring(latlong.indexOf(':') + 1);\r\n            var self = this;\r\n           var lat2= ProviderListController.currentlatlong.coords.latitude;\r\n           var long2= ProviderListController.currentlatlong.coords.longitude;\r\n           var R = 6378137; // Earthâ€™s mean radius in meter\r\n           var dLat = self.rad(lat2 - lat1);\r\n           var dLong = self.rad(long2 - long1);\r\n            var a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +\r\n                Math.cos(self.rad(lat1)) * Math.cos(self.rad(lat2)) * Math.sin(dLong / 2) * Math.sin(dLong / 2);\r\n            var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n            var d = R * c;\r\n            self.ServiceData[index].distance = (d / 1609.344).toFixed(1);\r\n          \r\n           // returns the distance in meter\r\n      \r\n        }\r\n        onSuccess(position: any) {\r\n          \r\n            ProviderListController.currentlatlong = position;\r\n         //   alert(JSON.stringify(ProviderListController.currentlatlong.coords.latitude +\", \"+ProviderListController.currentlatlong.coords.longitude ))\r\n        }\r\n        rad(x: any) {\r\n            return x * Math.PI / 180;\r\n        };\r\n        onError() {\r\n\r\n        }\r\n        getProfilePics(photoID: any, index: any) {\r\n            var self = this;\r\n\r\n            self.CustomerHttp.get('/GetProfilePic/' + photoID).then(function (response: any) {\r\n\r\n                //self.profilePic = \"http://dev.spafoo.com\" + response.GetProfilePicResult;\r\n                self.ServiceData[index].profileField.photoField = \"http://dev.spafoo.com\" + response.GetProfilePicResult;\r\n                //  alert(self.ServiceData[index].profileField.photoField);\r\n                self.$ionicLoading.hide();\r\n            }, function (error) {\r\n                if (error === null) {\r\n                    self.$ionicLoading.hide();\r\n                } else {\r\n                    console.log(error);\r\n                    self.$ionicLoading.hide();\r\n                }\r\n            });\r\n        }\r\n\r\n        GetProTagLine(UserID: any, index: any) {\r\n            var self = this;\r\n\r\n            self.CustomerHttp.get('/GetProTagLine/' + UserID).then(function (response: any) {\r\n                self.ServiceData[index].TagField = decodeURIComponent(decodeURI(response.GetProTagLineResult.Success));\r\n            }, function (error) {\r\n                if (error === null) {\r\n\r\n                } else {\r\n                    //console.log(error);\r\n\r\n                }\r\n            });\r\n        }\r\n        GetMyRating(UserID: any, index: any) {\r\n            var self = this;\r\n            self.CustomerHttp.get('/GetMyRating/' + UserID).then(function (response: any) {\r\n                self.ServiceData[index].starField = parseInt(response.GetMyRatingResult.Success.split(':')[0]);\r\n                 self.ServiceData[index].Rateperson= parseInt(response.GetMyRatingResult.Success.split(':')[1]);\r\n                //   alert(self.ServiceData[index].starField);\r\n            }, function (error) {\r\n                if (error === null) {\r\n\r\n                } else {\r\n                    console.log(error);\r\n\r\n                }\r\n            });\r\n        }\r\n        GoToProviderPortfolio(UserID: any) {\r\n            var self = this;\r\n            \r\n            //this.$rootScope.dotest(UserID) \r\n            self.$window.localStorage.setItem('ProviderIDs', UserID);\r\n            self.$state.go(\"ProviderPortfolio\");\r\n        }\r\n    }\r\n\r\n\r\n    angular.module('spafoo.ctrl.ProviderList', []).controller('ProviderList', ProviderListController);\r\n\r\n}"],"sourceRoot":"/source/"}