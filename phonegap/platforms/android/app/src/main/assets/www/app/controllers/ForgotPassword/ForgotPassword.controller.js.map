{"version":3,"sources":["controllers/ForgotPassword/ForgotPassword.controller.ts"],"names":[],"mappings":"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","file":"controllers/ForgotPassword/ForgotPassword.controller.js","sourcesContent":["module ForgotPasswordController {\r\n\r\n    class ForgotPasswordController {\r\n\r\n        static $inject = ['$q', '$state', '$ionicPopup', '$ionicLoading', '$scope', '$location', 'CustomerHttp', '$window'];\r\n        username: string;\r\n        password: string;\r\n        messages: string;\r\n        MainView: string;\r\n        VerifiedEmail: string;\r\n        constructor(\r\n            private $q: ng.IQService,\r\n            private $state: angular.ui.IStateService,\r\n            private $ionicPopup: ionic.popup.IonicPopupService,\r\n            private $ionicLoading: ionic.loading.IonicLoadingService,\r\n            private $scope: ng.IScope,\r\n            private $location: ng.ILocationService,\r\n            private CustomerHttp: spafoo.httpservice.ICustomerScreenHttp,\r\n            private $window: ng.IWindowService\r\n        ) {\r\n            var self = this;\r\n            self.MainView = 'Send-Code';\r\n        }\r\n\r\n        doSendCode(Regdata: any) {\r\n            var self = this;\r\n\r\n            if (Regdata == undefined) {\r\n\r\n                self.messages = \"Please Enter Email Address.\";\r\n                $(\"#PDoneError\").modal();\r\n                return false;\r\n            }\r\n            if (Regdata.EmailAddress === null || Regdata.EmailAddress === '' || Regdata.EmailAddress == undefined) {\r\n                self.messages = \"Please Enter Email Address.\";\r\n                $(\"#PDoneError\").modal();\r\n                return false;\r\n            } else {\r\n                var filter = /^([a-zA-Z0-9_\\.\\-])+\\@(([a-zA-Z0-9\\-])+\\.)+([a-zA-Z0-9]{2,4})+$/;\r\n                if (!filter.test(Regdata.EmailAddress)) {\r\n                    self.messages = \"Invalid email address.\";\r\n                    $(\"#PDoneError\").modal();\r\n                    return false;\r\n                }\r\n            }\r\n\r\n            self.CustomerHttp.get('/RequestVCode/' + Regdata.EmailAddress).then(function (response) {\r\n                if (response.RequestVCodeResult == \"done\") {\r\n                    self.MainView = 'Enter-Code';\r\n                    self.VerifiedEmail = Regdata.EmailAddress;\r\n                }\r\n                else {\r\n                    self.messages = \"Entered email does not match, please try again.\";\r\n                    $(\"#PDoneError\").modal();\r\n                }\r\n            }, function (error) { });\r\n        }\r\n\r\n\r\n\r\n\r\n        doConfirmCode(Regdata: any) {\r\n            var self = this;\r\n            if (Regdata == undefined) {\r\n\r\n                self.messages = \"Please enter new password.\";\r\n                $(\"#PDoneError\").modal();\r\n                return false;\r\n            }\r\n\r\n            if (Regdata.code === null || Regdata.code === '' || Regdata.code == undefined) {\r\n                self.messages = \"Please enter code.\";\r\n                $(\"#PDoneError\").modal();\r\n                return false;\r\n            }\r\n            self.CustomerHttp.get('/VerifyCode/' + self.VerifiedEmail + '/' + Regdata.code).then(function (response) {\r\n                if (response.VerifyCodeResult == \"1\") {\r\n                    self.MainView = 'Enter-NewPassword';\r\n                }\r\n                else {\r\n                    self.messages = \"Verification Code you enter is wrong.\";\r\n                    $(\"#PDoneError\").modal();\r\n                }\r\n            }, function (error) { });\r\n\r\n\r\n\r\n        }\r\n        doNewPassword(Regdata: any) {\r\n            var self = this;\r\n            if (this.DoValidation(Regdata)) {\r\n                var data = Regdata;\r\n                data.UserEmailID = self.VerifiedEmail;\r\n                self.CustomerHttp.post(data, '/ChangePwd').then(function (response) {\r\n\r\n                    if (response == \"1\") {\r\n                        self.MainView = 'Enter-Success';\r\n                        self.$window.localStorage.setItem(\"url\", 'Register');\r\n                    }\r\n                    else {\r\n                        self.messages = \"Password not changed successfully.\";\r\n                        $(\"#PDoneError\").modal();\r\n                    }\r\n                }, function (error) { });\r\n            }\r\n\r\n        }\r\n\r\n        back2SendCode(currentPage: any) {\r\n            var self = this;\r\n            switch (currentPage) {\r\n                case 'Enter-Code': self.MainView = 'Send-Code';\r\n                    break;\r\n                case 'Enter-NewPassword': self.MainView = 'Enter-Code';\r\n                    break;\r\n\r\n            }\r\n        }\r\n\r\n\r\n\r\n        doForgotPassword(Regdata: any) {\r\n\r\n            var self = this;\r\n\r\n            //if (this.DoValidation(Regdata)) {\r\n            //    var customerID = self.$window.localStorage.getItem('CustomerID');\r\n            //    var data = Regdata;\r\n            //    data.UserID = parseInt(customerID);\r\n            //    self.$ionicLoading.show();\r\n            //    self.CustomerHttp.post(data, '/ForgotPasswordUser').then(function (response) {\r\n            //        self.messages = response.Success;\r\n            //        $(\"#PDone\").modal();\r\n            //        if (response.Success == \"Password changed successfully\") {\r\n            //            setTimeout(function () { window.history.go(-1); }, 10000);\r\n            //        }\r\n            //        self.$ionicLoading.hide();\r\n            //    }, function (error) {\r\n            //        if (error === null) {\r\n            //            self.$ionicLoading.hide();\r\n            //        } else {\r\n            //            console.log(error);\r\n            //            self.$ionicLoading.hide();\r\n            //        }\r\n\r\n            //    });\r\n            //}\r\n        }\r\n\r\n        DoValidation(Regdata: any) {\r\n            var self = this;\r\n\r\n            if (Regdata == undefined) {\r\n\r\n                self.messages = \"Please Enter New Password.\";\r\n                $(\"#PDoneError\").modal();\r\n\r\n                return false;\r\n            }\r\n\r\n            if (Regdata.NewPassword === null || Regdata.NewPassword === '' || Regdata.NewPassword == undefined) {\r\n                self.messages = \"Please Enter New Password.\";\r\n                $(\"#PDoneError\").modal();\r\n                return false;\r\n            }\r\n            if (Regdata.ConfirmNewPassword === null || Regdata.ConfirmNewPassword === '' || Regdata.ConfirmNewPassword == undefined) {\r\n\r\n                self.messages = \"Please Enter Confirm New Password. \";\r\n                $(\"#PDoneError\").modal();\r\n                return false;\r\n            }\r\n\r\n            if (Regdata.ConfirmNewPassword != Regdata.NewPassword) {\r\n                self.messages = \"Password Not Matched. \";\r\n                $(\"#PDoneError\").modal();\r\n                return false;\r\n            }\r\n\r\n            return true;\r\n        }\r\n\r\n    }\r\n\r\n\r\n    angular.module('spafoo.ctrl.ForgotPassword', []).controller('ForgotPassword', ForgotPasswordController);\r\n\r\n}"],"sourceRoot":"/source/"}